"use strict";(self.webpackChunkcsgoroll=self.webpackChunkcsgoroll||[]).push([["default-libs_chat_src_index_ts","libs_giveaway_src_index_ts","libs_gemstone_src_lib_shared_index_ts"],{66219:(xe,B,s)=>{s.r(B),s.d(B,{ChatComponent:()=>se,ChatModule:()=>De,ChatPageComponent:()=>fe,PopupChatComponent:()=>V});var x=s(45990),e=s(54530),o=s(5e3);const X=new o.OlP("chat-config"),d={quickMuteSeconds:3600};var F=s(23600),j=s(69273),m=s(77093),U=s(89979),re=s(4834),Z=s(70655),b=s(93075),L=s(44987),w=s(13302),le=s(77579),z=s(54004),D=s(39841),_e=s(36129),K=s(70262),oe=s(5963),q=s(63900),g=s(60515);const p=s(39478).Ps`
  mutation ComposeForm($input: CreateMessageInput!) {
    createMessage(input: $input) {
      message {
        id
      }
    }
  }
`;var M=s(69808),S=s(35357),y=s(89847),H=s(47423),N=s(31495),ee=s(96298),ae=s(88634),me=s(59864);const R=function(){return["/login"]};function ye(r,_){1&r&&(o.ynx(0),o.TgZ(1,"a",1),o.TgZ(2,"span"),o.SDv(3,2),o.qZA(),o.qZA(),o.BQk()),2&r&&(o.xp6(1),o.Q6J("routerLink",o.DdM(1,R)))}function ge(r,_){if(1&r&&(o.ynx(0),o.TgZ(1,"div",3),o.TgZ(2,"span"),o.tHW(3,4),o._UZ(4,"br"),o.ALo(5,"date"),o.N_p(),o.qZA(),o.qZA(),o.BQk()),2&r){const l=_.ngIf;o.xp6(5),o.pQV(o.xi3(5,1,l,"medium")),o.QtT(3)}}const pe=function(){return["/top-up"]};function Oe(r,_){if(1&r&&(o.ynx(0),o.TgZ(1,"a",1),o.TgZ(2,"span"),o.tHW(3,5),o._UZ(4,"cw-pretty-balance",6),o.N_p(),o.qZA(),o.qZA(),o.BQk()),2&r){const l=_.ngIf;o.xp6(1),o.Q6J("routerLink",o.DdM(2,pe)),o.xp6(3),o.Q6J("balance",l)}}function h(r,_){if(1&r&&(o.ynx(0),o.YNc(1,Oe,5,3,"ng-container",0),o.ALo(2,"asyncInner"),o.BQk()),2&r){const l=o.oxw();o.xp6(1),o.Q6J("ngIf",o.lcZ(2,1,l.minimumDepositRequirement$))}}function Fe(r,_){if(1&r){const l=o.EpF();o.TgZ(0,"button",11),o.NdJ("click",function(v){return o.CHM(l),o.oxw(2).send(v)}),o._UZ(1,"cw-icon",12),o.ALo(2,"seasonalBranding"),o.qZA()}2&r&&(o.xp6(1),o.Q6J("inlineSVG",o.lcZ(2,1,"assets/icons/send.svg")))}function we(r,_){if(1&r){const l=o.EpF();o.TgZ(0,"button",11),o.NdJ("click",function(v){return o.CHM(l),o.oxw(3).send(v)}),o._uU(1,"SEND"),o.qZA()}}function de(r,_){1&r&&(o.TgZ(0,"div",13),o.YNc(1,we,2,0,"button",14),o.qZA()),2&r&&(o.xp6(1),o.Q6J("cwMediaIf","lt-sm"))}function Te(r,_){if(1&r){const l=o.EpF();o.ynx(0),o.TgZ(1,"div",7),o.TgZ(2,"textarea",8),o.NdJ("keydown.enter",function(v){return o.CHM(l),o.oxw().send(v)}),o.qZA(),o.YNc(3,Fe,3,3,"button",9),o.YNc(4,de,2,1,"div",10),o.qZA(),o.BQk()}if(2&r){const l=o.oxw();o.xp6(2),o.Q6J("formControl",l.ctrl),o.xp6(1),o.Q6J("ngIf",l.appConfig.chat.showSendMessageBtn),o.xp6(1),o.Q6J("ngIf",!l.appConfig.chat.showSendMessageBtn)}}let $=class{constructor(_,l,C,v,ie){this.environment=_,this.appConfig=l,this.apollo=C,this.userService=v,this.settingsService=ie,this.channel="en",this.create=new o.vpe,this.ctrl=new b.NI("",[b.kI.required,b.kI.maxLength(255)]),this.send$=new le.x,this.unlockedChat$=this.userService.unlockedChat$,this.isUserLoggedIn$=this.userService.isUserLoggedIn$,this.mutedUntilDate$=this.userService.mutedUntilDate$,this.minimumDepositRequirement$=this.settingsService.getSetting("chat:minimum_deposit_requirement").pipe((0,z.U)(I=>I?+I.value:0)),this.canChat$=(0,D.a)([this.isUserLoggedIn$,this.mutedUntilDate$.pipe((0,z.U)(I=>!I)),this.unlockedChat$]).pipe((0,z.U)(I=>I.every(Q=>!!Q))),this.send$.pipe((0,_e.z)(I=>this.apollo.mutate({mutation:p,variables:{input:{channel:this.channel,body:I}}}).pipe((0,K.K)(()=>(0,oe.H)(1e3).pipe((0,q.w)(()=>g.E))))),(0,L.t)(this)).subscribe(({data:I})=>{this.create.next(I),this.ctrl.reset()},I=>this.ctrl.reset())}send(_){_.preventDefault(),this.ctrl.valid&&this.send$.next(this.ctrl.value)}};function Ce(r,_){if(1&r){const l=o.EpF();o.ynx(0),o.TgZ(1,"button",4),o.NdJ("click",function(){return o.CHM(l),o.oxw().closeChat()}),o._UZ(2,"cw-icon",5),o.qZA(),o.BQk()}}$.\u0275fac=function(_){return new(_||$)(o.Y36(F.pgb),o.Y36(F.qBz),o.Y36(w._M),o.Y36(F.KDu),o.Y36(F.RCL))},$.\u0275cmp=o.Xpm({type:$,selectors:[["cw-compose-form"]],inputs:{channel:"channel"},outputs:{create:"create"},decls:8,vars:12,consts:function(){let r,_,l,C;return r=$localize`:␟1c2284a5424e2972925217d59734144abfdfc134␟6852981929727434674:You must login to chat`,_=$localize`:␟b44fbaeb5cac16b3de16569b4c650540abce2aed␟5135939808022186407:You are muted until:${"\ufffd#4\ufffd\ufffd/#4\ufffd"}:LINE_BREAK:${"\ufffd0\ufffd"}:INTERPOLATION:`,l=$localize`:␟183ca6c5332883aaac2e9dbbcb342ceba83dc33a␟8011635248109187786:You must deposit at least ${"\ufffd#4\ufffd"}:START_TAG_CW_PRETTY_BALANCE:${"\ufffd/#4\ufffd"}:CLOSE_TAG_CW_PRETTY_BALANCE: to chat`,C=$localize`:␟4e9bd6ce9ff86240ac451f7fe97f4709d0eb79ae␟9054063932528144894:Type message...`,[[4,"ngIf"],[1,"notice",3,"routerLink"],r,[1,"notice"],_,l,[3,"balance"],["fxLayout","",1,"text-area-container"],["cols","30","rows","1","maxlength","255","placeholder",C,1,"form-control",3,"formControl","keydown.enter"],["type","button","mat-button","","color","primary",3,"click",4,"ngIf"],["fxLayout","",4,"ngIf"],["type","button","mat-button","","color","primary",3,"click"],[3,"inlineSVG"],["fxLayout",""],["type","button","mat-button","","color","primary",3,"click",4,"cwMediaIf"]]},template:function(_,l){1&_&&(o.YNc(0,ye,4,2,"ng-container",0),o.ALo(1,"asyncInner"),o.YNc(2,ge,6,4,"ng-container",0),o.ALo(3,"asyncInner"),o.YNc(4,h,3,3,"ng-container",0),o.ALo(5,"asyncInner"),o.YNc(6,Te,5,3,"ng-container",0),o.ALo(7,"asyncInner")),2&_&&(o.Q6J("ngIf",!1===o.lcZ(1,4,l.isUserLoggedIn$)),o.xp6(2),o.Q6J("ngIf",o.lcZ(3,6,l.mutedUntilDate$)),o.xp6(2),o.Q6J("ngIf",!1===o.lcZ(5,8,l.unlockedChat$)),o.xp6(2),o.Q6J("ngIf",o.lcZ(7,10,l.canChat$)))},directives:[M.O5,S.yS,y.q,m.xw,b.Fj,b.nD,b.JJ,b.oH,H.lW,N.o,ee.d$,U.h],pipes:[ae.d,M.uU,me.A],styles:["[_nghost-%COMP%]{position:relative;display:flex;padding:.5rem 1.25rem}.notice[_ngcontent-%COMP%]{padding:1rem;text-align:center;width:100%}.notice[_ngcontent-%COMP%]   cw-pretty-balance[_ngcontent-%COMP%]{margin:0 3px}.text-area-container[_ngcontent-%COMP%]{padding:1rem 0}textarea[_ngcontent-%COMP%]{color:var(--body-color);font-size:.8rem;border:0;border-radius:0;background:0;resize:none;line-height:1}textarea[_ngcontent-%COMP%]:focus{outline:0}.text-area-container[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%]{width:100%}button[_ngcontent-%COMP%]{padding:0 1rem 0 .5rem;background:none;border:0;border-top:2px solid #1a1e23;border-color:transparent}"],changeDetection:0}),$=(0,Z.gn)([(0,L.c)(),(0,Z.w6)("design:paramtypes",[Object,Object,w._M,F.KDu,F.RCL])],$);let se=(()=>{class r{constructor(l,C){this.userService=l,this.layoutService=C,this.userId$=this.userService.userId$}scrollToBottom(){this.messageList.onScrollToBottom()}closeChat(){this.layoutService.toggleSidenavElement("chat")}}return r.\u0275fac=function(l){return new(l||r)(o.Y36(F.KDu),o.Y36(F.Pb3))},r.\u0275cmp=o.Xpm({type:r,selectors:[["cw-chat"]],viewQuery:function(l,C){if(1&l&&o.Gf(j.K,7),2&l){let v;o.iGM(v=o.CRH())&&(C.messageList=v.first)}},decls:7,vars:5,consts:[["fxLayout","column","fxFlex","",1,"inner"],[1,"position-relative"],[4,"cwMediaIf"],["fxFlex","",3,"cached","userId"],["mat-icon-button","",1,"close",3,"click"],["inlineSVG","assets/icons/close.svg"]],template:function(l,C){1&l&&(o.TgZ(0,"div",0),o.TgZ(1,"div",1),o.YNc(2,Ce,3,0,"ng-container",2),o.qZA(),o._UZ(3,"cw-message-list",3),o.ALo(4,"asyncInner"),o._UZ(5,"mat-divider"),o._UZ(6,"cw-compose-form"),o.qZA()),2&l&&(o.xp6(2),o.Q6J("cwMediaIf","lt-md"),o.xp6(1),o.Q6J("cached",!0)("userId",o.lcZ(4,3,C.userId$)))},directives:[m.xw,m.yH,U.h,j.K,re.d,$,H.lW,N.o,ee.d$],pipes:[ae.d],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;flex:1;background:var(--main-elements-bg)}.inner[_ngcontent-%COMP%]{max-width:100%}.chat-header[_ngcontent-%COMP%]{padding:.25rem .75rem .5rem;border-bottom:1px solid rgba(0,0,0,.06)}button.close[_ngcontent-%COMP%]{height:1.75rem;width:1.75rem;display:flex;justify-content:center;align-items:center;background-color:#000;border-radius:0;padding-left:.15rem}button.close[_ngcontent-%COMP%]   cw-icon[_ngcontent-%COMP%]{color:#fff}cw-message-list[_ngcontent-%COMP%], cw-compose-form[_ngcontent-%COMP%]{padding:0 1rem}mat-divider[_ngcontent-%COMP%]{color:var(--chat-divider-color);margin-top:1rem}"],changeDetection:0}),r})(),fe=(()=>{class r{constructor(){}ngOnInit(){}}return r.\u0275fac=function(l){return new(l||r)},r.\u0275cmp=o.Xpm({type:r,selectors:[["cw-chat-page"]],decls:1,vars:0,template:function(l,C){1&l&&o._UZ(0,"cw-chat")},directives:[se],styles:["[_nghost-%COMP%]{display:flex;flex:1;min-height:calc(100vh - 4.375rem - var(--vertical-spacing))}"],changeDetection:0}),r})();const Me=[{path:"",component:fe,data:{sidenavStartsClosed:!0,footer:!1}}];let ue=(()=>{class r{}return r.\u0275fac=function(l){return new(l||r)},r.\u0275mod=o.oAB({type:r}),r.\u0275inj=o.cJS({imports:[[S.Bz.forChild(Me)],S.Bz]}),r})(),De=(()=>{class r{static forRoot(l=d){return{ngModule:r,providers:[{provide:X,useValue:l}]}}}return r.\u0275fac=function(l){return new(l||r)},r.\u0275mod=o.oAB({type:r}),r.\u0275inj=o.cJS({imports:[[M.ez,x.vY,ue,e.GemstoneSharedModule]]}),r})();var Se=s(41183);function Ie(r,_){1&r&&o._UZ(0,"cw-chat")}let V=class{constructor(_){this.popupWindowService=_,this.popupStates=x.Fg,this.popupWindowService.popupState$.pipe((0,L.t)(this)).subscribe(l=>{var C;this.popupState=l,null===(C=this.chatComponent)||void 0===C||C.scrollToBottom()})}};V.\u0275fac=function(_){return new(_||V)(o.Y36(x.El))},V.\u0275cmp=o.Xpm({type:V,selectors:[["cw-popup-chat"]],viewQuery:function(_,l){if(1&_&&o.Gf(se,5),2&_){let C;o.iGM(C=o.CRH())&&(l.chatComponent=C.first)}},decls:2,vars:1,consts:[[4,"ngIf"]],template:function(_,l){1&_&&(o.TgZ(0,"cw-popup-window"),o.YNc(1,Ie,1,0,"cw-chat",0),o.qZA()),2&_&&(o.xp6(1),o.Q6J("ngIf",l.popupState!==l.popupStates.CLOSED))},directives:[Se.r,M.O5,se],styles:[""],changeDetection:0}),V=(0,Z.gn)([(0,L.c)(),(0,Z.w6)("design:paramtypes",[x.El])],V)},69273:(xe,B,s)=>{s.d(B,{K:()=>te});var x=s(70655),e=s(5e3),o=s(23600),X=s(93114),d=s(95676),F=s(44987),j=s(9124),m=s(13302),U=s(61135),re=s(50727),Z=s(77579),b=s(54968),L=s(68675),w=s(54004),le=s(23601),z=s(71884),D=s(18505),_e=s(13099),K=s(39841),oe=s(11365),q=s(63900),g=s(39646),O=s(39300),p=s(60515),M=s(38502),S=s(95698),y=s(50590),H=s(48966),N=s(24750),ee=s(9772),ae=s(51199),me=s(45990),R=s(39478);const ye=R.Ps`
  fragment UserMessage on User {
    id
    name
    avatar
    roles
    authentic
    customTitle
    customTitleColor
    teamId
    userProgress {
      id
      level
    }
  }
`,ge=R.Ps`
  fragment Message on Message {
    id
    body
    createdAt
    user {
      ...UserMessage
    }
    type
    meta: meta2 {
      name
      currency
      totalValue
      externalId
      user {
        ...UserMessage
      }
      userGiveaways {
        id
        user {
          ...UserMessage
        }
        rewardAmount
      }
      giveaway {
        id
        name
        rewardAmount
        winnersAmount
        currency
        startAt
        walletType
      }
      boxOpening {
        id
        itemValue
        currency
        box {
          id
          name
          slug
          market {
            id
            slug
          }
          walletRestrictions
        }
      }
      gemstoneBoostActivation {
        id
        activatedByItemVariant {
          id
          externalId
          iconUrl
          name
        }
        activatedByUser {
          ...UserMessage
        }
        amountMultiplier
        gemstoneBoost {
          id
          teamGemstoneThreshold
          currency
          walletType
        }
        team {
          id
          name
        }
      }
    }
  }

  ${ye}
`,pe=R.Ps`
  mutation DeleteMessages($input: DeleteMessagesInput!) {
    deleteMessages(input: $input) {
      messages {
        id
        userId
      }
    }
  }
`,Oe=R.Ps`
  mutation MuteUser($input: UpdateUserInput!) {
    updateUser(input: $input) {
      user {
        id
        mutedUntil
      }
    }
  }
`;var h=s(69808),Fe=s(35357),we=s(27737),de=s(31495),Te=s(96298),$=s(47423),Ce=s(77093),se=s(89847),fe=s(966),Me=s(72495),ue=s(79586),De=s(76688),Se=s(88634),Ie=s(30152),V=s(43343),r=s(70653);let _=(()=>{class n{constructor(t){this.appConfig=t}transform(t,i){switch(t){case d.C.GAME_JACKPOT_1X:case d.C.GAME_JACKPOT_2X:case d.C.GAME_JACKPOT_3X:return"Roll";case d.C.PVP_BOX_GAME_BIG_WIN:case d.C.BOX_OPENING:return(null==i?void 0:i.toString())===r.w.GEMSTONE?this.appConfig.gemstones.label:"Unboxing";case d.C.JACKPOT_TICKET_WIN:return"Jackpot";case d.C.GIVEAWAY_CREATED:case d.C.GIVEAWAY_STARTED:case d.C.GIVEAWAY_COMPLETED:return"Giveaways";default:return""}}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(o.qBz,16))},n.\u0275pipe=e.Yjl({name:"messageTypeProduct",type:n,pure:!0}),n})();var l=s(56284),C=s(20975);function v(n,a){if(1&n&&e._UZ(0,"div",16),2&n){const t=e.oxw(2);e.Udp("background-color",null==t.user?null:t.user.customTitleColor)}}function ie(n,a){if(1&n&&e._UZ(0,"cw-user-avatar-badge",20),2&n){const t=e.oxw(3);e.Q6J("user",t.user)("small",!0)("authenticBadge",!0)}}function I(n,a){if(1&n&&e._UZ(0,"img",21),2&n){const t=e.oxw(3);e.Q6J("src",t.user.avatar,e.LSH)}}const Q=function(n){return["/player",n]};function Be(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"a",17),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).closeChat()}),e.YNc(1,ie,1,3,"cw-user-avatar-badge",18),e.YNc(2,I,1,1,"img",19),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("routerLink",e.VKq(3,Q,t.user.id)),e.xp6(1),e.Q6J("ngIf",t.appConfig.chat.showXp),e.xp6(1),e.Q6J("ngIf",!t.appConfig.chat.showXp)}}function Ze(n,a){if(1&n&&(e.TgZ(0,"div",22),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.Udp("color",null==t.user?null:t.user.customTitleColor),e.xp6(1),e.hij(" ",t.user.customTitle," ")}}function Re(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"button",23),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).showMenuState()}),e._uU(1,"..."),e.qZA()}}function Qe(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"a",32),e.NdJ("click",function(){return e.CHM(t),e.oxw(4).deleteAll()}),e._UZ(1,"cw-icon",33),e.TgZ(2,"div"),e.SDv(3,34),e.qZA(),e.qZA()}}function Je(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"a",32),e.NdJ("click",function(){return e.CHM(t),e.oxw(4).delete()}),e._UZ(1,"cw-icon",33),e.TgZ(2,"div"),e.SDv(3,35),e.qZA(),e.qZA()}}function Ye(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"a",32),e.NdJ("click",function(){return e.CHM(t),e.oxw(4).showMenuState("MUTE")}),e._UZ(1,"cw-icon",36),e.TgZ(2,"div"),e.SDv(3,37),e.qZA(),e.qZA()}}function Ue(n,a){if(1&n&&(e.TgZ(0,"div",27),e.YNc(1,Qe,4,0,"a",28),e.ALo(2,"asyncInner"),e.YNc(3,Je,4,0,"a",28),e.ALo(4,"asyncInner"),e.YNc(5,Ye,4,0,"a",28),e.ALo(6,"asyncInner"),e.TgZ(7,"a",29),e._UZ(8,"cw-icon",30),e.TgZ(9,"div"),e.SDv(10,31),e.qZA(),e.qZA(),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("ngIf",e.lcZ(2,4,t.canDeleteMessages$)),e.xp6(2),e.Q6J("ngIf",e.lcZ(4,6,t.canDeleteMessages$)),e.xp6(2),e.Q6J("ngIf",e.lcZ(6,8,t.canMute$)),e.xp6(2),e.Q6J("routerLink",t.user?e.VKq(10,Q,t.user.id):void 0)}}function He(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",38),e.SDv(2,39),e.qZA(),e.TgZ(3,"div",27),e.TgZ(4,"div",40),e.TgZ(5,"button",41),e.NdJ("click",function(){return e.CHM(t),e.oxw(3).mute(5)}),e.SDv(6,42),e.qZA(),e.qZA(),e.TgZ(7,"div",40),e.TgZ(8,"button",41),e.NdJ("click",function(){return e.CHM(t),e.oxw(3).mute(60)}),e.SDv(9,43),e.qZA(),e.qZA(),e.TgZ(10,"div",40),e.TgZ(11,"button",41),e.NdJ("click",function(){return e.CHM(t),e.oxw(3).mute(1440)}),e.SDv(12,44),e.qZA(),e.qZA(),e.TgZ(13,"div",40),e.TgZ(14,"button",41),e.NdJ("click",function(){return e.CHM(t),e.oxw(3).mute(10080)}),e.SDv(15,45),e.qZA(),e.qZA(),e.TgZ(16,"div",40),e.TgZ(17,"button",41),e.NdJ("click",function(){return e.CHM(t),e.oxw(3).mute(525600)}),e.SDv(18,46),e.qZA(),e.qZA(),e.qZA(),e.BQk()}}function Ve(n,a){if(1&n&&(e.TgZ(0,"section",24),e.YNc(1,Ue,11,12,"div",25),e.YNc(2,He,19,0,"ng-container",26),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("ngSwitch",t.menuState),e.xp6(2),e.Q6J("ngSwitchCase","MUTE")}}function ke(n,a){if(1&n&&(e.TgZ(0,"article",3),e.YNc(1,v,1,2,"div",4),e.TgZ(2,"section",5),e.TgZ(3,"section",6),e.YNc(4,Be,3,5,"a",7),e.TgZ(5,"div",8),e.TgZ(6,"div",9),e.YNc(7,Ze,2,3,"div",10),e.TgZ(8,"span",11),e._uU(9),e.qZA(),e.YNc(10,Re,2,0,"button",12),e.qZA(),e.TgZ(11,"div",13),e.TgZ(12,"div",14),e._uU(13),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.YNc(14,Ve,3,2,"section",15),e.qZA(),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.appConfig.chat.flare&&(null==t.user?null:t.user.customTitleColor)),e.xp6(3),e.Q6J("ngIf",t.user),e.xp6(3),e.Q6J("ngIf",null==t.user?null:t.user.customTitle),e.xp6(2),e.hij(" ",t.user?t.user.name:"System"," "),e.xp6(1),e.Q6J("ngIf",t.user),e.xp6(3),e.hij(" ",t.message.body," "),e.xp6(1),e.Q6J("ngIf",t.menuState)}}function We(n,a){if(1&n&&e._UZ(0,"cw-user-avatar-badge",57),2&n){const t=e.oxw(3);e.Q6J("user",t.message.meta.user)}}function Xe(n,a){if(1&n&&e._UZ(0,"img",21),2&n){const t=e.oxw(3);e.Q6J("src",t.message.meta.user.avatar,e.LSH)}}function je(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"a",17),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).closeChat()}),e.YNc(2,We,1,1,"cw-user-avatar-badge",56),e.YNc(3,Xe,1,1,"img",19),e.qZA(),e.BQk()}if(2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("routerLink",e.VKq(3,Q,t.message.meta.user.id)),e.xp6(1),e.Q6J("ngIf",t.appConfig.chat.showXp),e.xp6(1),e.Q6J("ngIf",!t.appConfig.chat.showXp)}}const $e=function(){return["/roll"]};function ze(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"div",58),e.TgZ(2,"div"),e.tHW(3,59),e._UZ(4,"cw-pretty-balance",60),e.N_p(),e.qZA(),e.TgZ(5,"a",61),e._uU(6,"Take me to Roll"),e.qZA(),e.qZA(),e.BQk()),2&n){const t=e.oxw(2);e.xp6(4),e.Q6J("balance",t.message.meta.totalValue)("currency",t.message.meta.currency),e.pQV(" "),e.QtT(3),e.xp6(1),e.Q6J("routerLink",e.DdM(4,$e))}}function Ke(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"div",58),e.TgZ(2,"div"),e.tHW(3,62),e._UZ(4,"cw-pretty-balance",60),e.N_p(),e.qZA(),e.TgZ(5,"a",61),e._uU(6,"Take me to Roll"),e.qZA(),e.qZA(),e.BQk()),2&n){const t=e.oxw(2);e.xp6(4),e.Q6J("balance",t.message.meta.totalValue)("currency",t.message.meta.currency),e.pQV(" "),e.QtT(3),e.xp6(1),e.Q6J("routerLink",e.DdM(4,$e))}}function qe(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",63),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).openGameJackpotDialog()}),e.tHW(2,64),e._UZ(3,"cw-pretty-balance",60),e.N_p(),e.qZA(),e.BQk()}if(2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngbTooltip","Show Jackpot Winners"),e.xp6(2),e.Q6J("balance",t.message.meta.totalValue)("currency",t.message.meta.currency),e.pQV(" "),e.QtT(2)}}function et(n,a){1&n&&e.GkF(0)}const tt=function(n){return{$implicit:n,isPvp:!1}};function nt(n,a){if(1&n&&(e.ynx(0),e.YNc(1,et,1,0,"ng-container",65),e.BQk()),2&n){const t=e.oxw(2),i=e.MAs(4);e.xp6(1),e.Q6J("ngTemplateOutlet",i)("ngTemplateOutletContext",e.VKq(2,tt,t.message))}}function ot(n,a){1&n&&e.GkF(0)}const at=function(n){return{$implicit:n,isPvp:!0}};function st(n,a){if(1&n&&(e.ynx(0),e.YNc(1,ot,1,0,"ng-container",65),e.BQk()),2&n){const t=e.oxw(2),i=e.MAs(4);e.xp6(1),e.Q6J("ngTemplateOutlet",i)("ngTemplateOutletContext",e.VKq(2,at,t.message))}}const it=function(){return["/jackpots"]};function ct(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"div"),e.tHW(2,66),e._UZ(3,"a",67),e._UZ(4,"cw-pretty-balance",60),e.N_p(),e.qZA(),e.TgZ(5,"a",61),e._uU(6,"Go to jackpot"),e.qZA(),e.BQk()),2&n){const t=e.oxw(2);e.xp6(3),e.Q6J("routerLink",e.VKq(5,Q,t.message.meta.user.id)),e.xp6(1),e.Q6J("balance",t.message.meta.totalValue)("currency",t.message.meta.currency),e.pQV(t.message.meta.user.name),e.QtT(2),e.xp6(1),e.Q6J("routerLink",e.DdM(7,it))}}function rt(n,a){if(1&n&&(e.TgZ(0,"div"),e.tHW(1,68),e._UZ(2,"cw-wallet-balance",69),e.ALo(3,"number"),e.ALo(4,"timeUntil"),e.ALo(5,"timeUntil"),e.N_p(),e.qZA()),2&n){const t=a.ngIf,i=e.oxw(3);e.xp6(2),e.Q6J("balance",t.rewardAmount)("currency",t.currency)("walletType",t.walletType),e.xp6(3),e.pQV(t.name)(e.xi3(3,5,(e.lcZ(4,8,t.startAt)-e.lcZ(5,10,i.message.createdAt))/60,"1.0-0")),e.QtT(1)}}function lt(n,a){if(1&n&&(e.ynx(0),e.YNc(1,rt,6,12,"div",53),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",null==t.message.meta?null:t.message.meta.giveaway)}}function _t(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",38),e.tHW(2,70),e._UZ(3,"cw-wallet-balance",69),e.N_p(),e.qZA(),e.TgZ(4,"button",71),e.NdJ("click",function(){return e.CHM(t),e.oxw(3).joinGiveaway()}),e.TgZ(5,"cw-loader",72),e.SDv(6,73),e.ALo(7,"push"),e.qZA(),e.qZA(),e.BQk()}if(2&n){const t=a.ngIf,i=e.oxw(3);e.xp6(3),e.Q6J("balance",t.rewardAmount)("currency",t.currency)("walletType",t.walletType),e.pQV(t.name),e.QtT(2),e.xp6(2),e.Q6J("loading",e.lcZ(7,5,i.loading$))}}function gt(n,a){if(1&n&&(e.ynx(0),e.YNc(1,_t,8,7,"ng-container",53),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",null==t.message.meta?null:t.message.meta.giveaway)}}function ut(n,a){if(1&n&&(e.TgZ(0,"div",76),e._UZ(1,"cw-user-avatar-badge",77),e.TgZ(2,"div",78),e._uU(3),e.qZA(),e._UZ(4,"cw-wallet-balance",79),e.qZA()),2&n){const t=a.$implicit,i=e.oxw().ngIf;e.xp6(1),e.Q6J("user",t.user)("routerLink",e.VKq(6,Q,t.user.id)),e.xp6(2),e.Oqu(t.user.name),e.xp6(1),e.Q6J("balance",t.rewardAmount)("currency",i.currency)("walletType",i.walletType)}}const mt=function(){return[]};function pt(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"div",74),e._uU(2),e.qZA(),e.YNc(3,ut,5,8,"div",75),e.BQk()),2&n){const t=a.ngIf,i=e.oxw(3);e.xp6(2),e.hij("",t.name," completed!"),e.xp6(1),e.Q6J("ngForOf",i.message.meta.userGiveaways||e.DdM(2,mt))}}function Ft(n,a){if(1&n&&(e.ynx(0),e.YNc(1,pt,4,3,"ng-container",53),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",null==t.message.meta?null:t.message.meta.giveaway)}}function dt(n,a){if(1&n&&(e.tHW(0,80,1),e.GkF(1),e.N_p()),2&n){const t=a.ngIf,i=e.oxw().ngIf,c=e.oxw().ngIf,u=e.oxw(3);e.xp6(1),e.pQV(null==c.activatedByUser?null:c.activatedByUser.name)(t.externalId||t.name)(c.amountMultiplier)(u.gemstoneLabel)(null==i?null:i.name),e.QtT(0)}}function Tt(n,a){if(1&n&&(e.tHW(0,80,2),e._UZ(1,"cw-gemstone-balance",83),e.N_p()),2&n){const t=e.oxw().ngIf,i=e.oxw().ngIf,c=e.oxw(3);e.xp6(1),e.Q6J("balance",i.gemstoneBoost.teamGemstoneThreshold),e.pQV(null==t?null:t.name)(c.gemstoneLabelPlural)(i.amountMultiplier)(c.gemstoneLabel),e.QtT(0)}}function Ct(n,a){if(1&n&&(e.TgZ(0,"div"),e.tHW(1,80),e.YNc(2,dt,2,5,"ng-container",81),e.YNc(3,Tt,2,5,"ng-template",null,82,e.W1O),e.N_p(),e.qZA()),2&n){const t=e.MAs(4),i=e.oxw().ngIf;e.xp6(2),e.Q6J("ngIf",i.activatedByItemVariant)("ngIfElse",t)}}function ft(n,a){if(1&n&&(e.ynx(0),e.YNc(1,Ct,5,2,"div",53),e.BQk()),2&n){const t=a.ngIf;e.xp6(1),e.Q6J("ngIf",t.team)}}function Mt(n,a){if(1&n&&(e.ynx(0),e.YNc(1,ft,2,1,"ng-container",53),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",null==t.message.meta?null:t.message.meta.gemstoneBoostActivation)}}function St(n,a){if(1&n&&(e.ynx(0),e._uU(1),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.Oqu(t.message.body)}}function ht(n,a){if(1&n&&(e.TgZ(0,"article",3),e.TgZ(1,"section",5),e.TgZ(2,"section",47),e.TgZ(3,"div",48),e.TgZ(4,"div",9),e.TgZ(5,"div",49),e._UZ(6,"img",50),e.ALo(7,"async"),e.ALo(8,"themableAsset"),e.qZA(),e.TgZ(9,"span",11),e.TgZ(10,"span",51),e._uU(11),e.ALo(12,"appConfig"),e.qZA(),e._uU(13),e.ALo(14,"messageTypeProduct"),e.qZA(),e.qZA(),e.TgZ(15,"div",52),e.YNc(16,je,4,5,"ng-container",53),e.TgZ(17,"div",54),e.YNc(18,ze,7,5,"ng-container",26),e.YNc(19,Ke,7,5,"ng-container",26),e.YNc(20,qe,4,4,"ng-container",26),e.YNc(21,nt,2,4,"ng-container",26),e.YNc(22,st,2,4,"ng-container",26),e.YNc(23,ct,7,8,"ng-container",26),e.YNc(24,lt,2,1,"ng-container",26),e.YNc(25,gt,2,1,"ng-container",26),e.YNc(26,Ft,2,1,"ng-container",26),e.YNc(27,Mt,2,1,"ng-container",26),e.YNc(28,St,2,1,"ng-container",55),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&n){const t=e.oxw();e.xp6(6),e.Q6J("src",e.lcZ(7,15,e.lcZ(8,17,"assets/logo-compact.png")),e.LSH),e.xp6(5),e.Oqu(e.lcZ(12,19,"APP_NAME")),e.xp6(2),e.hij(" ",e.xi3(14,21,t.message.type,null==t.message.meta.boxOpening?null:t.message.meta.boxOpening.box.walletRestrictions)," "),e.xp6(3),e.Q6J("ngIf",null==t.message||null==t.message.meta?null:t.message.meta.user),e.xp6(1),e.Q6J("ngSwitch",t.message.type),e.xp6(1),e.Q6J("ngSwitchCase",t.MessageType.GAME_JACKPOT_1X),e.xp6(1),e.Q6J("ngSwitchCase",t.MessageType.GAME_JACKPOT_2X),e.xp6(1),e.Q6J("ngSwitchCase",t.MessageType.GAME_JACKPOT_3X),e.xp6(1),e.Q6J("ngSwitchCase",t.MessageType.BOX_OPENING),e.xp6(1),e.Q6J("ngSwitchCase",t.MessageType.PVP_BOX_GAME_BIG_WIN),e.xp6(1),e.Q6J("ngSwitchCase",t.MessageType.JACKPOT_TICKET_WIN),e.xp6(1),e.Q6J("ngSwitchCase",t.MessageType.GIVEAWAY_CREATED),e.xp6(1),e.Q6J("ngSwitchCase",t.MessageType.GIVEAWAY_STARTED),e.xp6(1),e.Q6J("ngSwitchCase",t.MessageType.GIVEAWAY_COMPLETED),e.xp6(1),e.Q6J("ngSwitchCase",t.MessageType.GEMSTONE_BOOST_ACTIVATION_CREATED)}}function Et(n,a){if(1&n&&(e.tHW(0,84,1),e.TgZ(1,"span"),e._UZ(2,"strong"),e.qZA(),e.N_p()),2&n){const t=e.oxw().ngIf;e.xp6(2),e.pQV(t.box.name),e.QtT(0)}}const At=function(n){return["/pvp",n]},vt=function(n,a){return["/boxes/view",n,a]};function xt(n,a){if(1&n&&(e.tHW(0,84,2),e._UZ(1,"a",87),e.N_p()),2&n){const t=e.oxw().ngIf,i=e.oxw(),c=i.isPvp,u=i.$implicit;e.xp6(1),e.Q6J("routerLink",c?e.VKq(2,At,u.meta.externalId):e.WLB(4,vt,t.box.market.slug,t.box.slug)),e.pQV(c?"VIEW DUEL":t.box.name),e.QtT(0)}}function yt(n,a){if(1&n&&e.SDv(0,84,3),2&n){const t=e.oxw().ngIf,i=e.oxw().isPvp;e.pQV(i?"VIEW DUEL":t.name),e.QtT(0)}}function Ot(n,a){if(1&n&&(e.TgZ(0,"div"),e.tHW(1,84),e._UZ(2,"a",67),e._UZ(3,"cw-pretty-balance",60),e.YNc(4,Et,3,1,"span",53),e.YNc(5,xt,2,7,"a",85),e.YNc(6,yt,1,1,"ng-template",null,86,e.W1O),e.N_p(),e.qZA()),2&n){const t=a.ngIf,i=e.MAs(7),c=e.oxw(),u=c.$implicit,f=c.isPvp;e.xp6(2),e.Q6J("routerLink",e.VKq(8,Q,u.meta.user.id)),e.xp6(1),e.Q6J("balance",t.itemValue||t.totalValue)("currency",t.currency),e.xp6(1),e.Q6J("ngIf",f),e.xp6(1),e.Q6J("ngIf",t.box)("ngIfElse",i),e.xp6(2),e.pQV(u.meta.user.name)(" "),e.QtT(1)}}function wt(n,a){if(1&n&&e.YNc(0,Ot,8,10,"div",53),2&n){const t=a.$implicit;e.Q6J("ngIf",t.meta.boxOpening||t.meta)}}let k=class{constructor(a,t,i,c,u,f,E,P,G){var T,W;this.appConfig=a,this.userService=t,this.apollo=i,this.dialog=c,this.giveawayService=u,this.loginService=f,this.rouletteService=E,this.confirmService=P,this.layoutService=G,this.isUserLoggedIn$=this.userService.isUserLoggedIn$,this.canMute$=this.userService.canMute$,this.canDeleteMessages$=this.userService.canDeleteMessages$,this.menuState=null,this.loadingChange=new Z.x,this.loading$=this.loadingChange.asObservable().pipe((0,L.O)(!1)),this.MessageType=d.C,this.gemstoneLabel=(null===(T=this.appConfig.gemstones)||void 0===T?void 0:T.label)||"Gemstone",this.gemstoneLabelPlural=(null===(W=this.appConfig.gemstones)||void 0===W?void 0:W.pluralLabel)||"Gemstones"}onMouseleave(){this.menuState=null}get giveaway(){var a;return null===(a=this.message.meta)||void 0===a?void 0:a.giveaway}get user(){return this.message.user}get messageId(){var a;return null===(a=this.message)||void 0===a?void 0:a.id}mute(a){this.menuState=null;const t=new Date;t.setMinutes(t.getMinutes()+a);const i={userId:this.message.user.id,mutedUntil:t.toISOString()};this.apollo.mutate({mutation:Oe,variables:{input:i}}).pipe((0,F.t)(this)).subscribe()}delete(){this.apollo.mutate({mutation:pe,variables:{input:{id:this.message.id,userId:this.message.user.id}}}).pipe((0,F.t)(this)).subscribe()}deleteAll(){this.confirmService.confirm({}).pipe((0,F.t)(this)).subscribe(a=>{a&&this.apollo.mutate({mutation:pe,variables:{input:{userId:this.message.user.id}}}).pipe((0,F.t)(this)).subscribe()})}showMenuState(a="CHOICES"){this.menuState=a}openGameJackpotDialog(){this.rouletteService.getGameJackpot(this.message.meta.externalId).pipe((0,S.q)(1)).subscribe(a=>{this.dialog.open(ae.RouletteJackpotWinComponent).componentInstance.gameJackpot=a})}closeChat(){this.layoutService.isMediaSize("lt-md").pipe((0,O.h)(a=>a),(0,S.q)(1),(0,F.t)(this)).subscribe(()=>{this.layoutService.toggleSidenavElement("chat")})}joinGiveaway(){return this.loadingChange.next(!0),this.loginService.openLoginIfNoUser().pipe((0,q.w)(()=>this.giveawayService.join(this.giveaway.id,()=>this.loadingChange.next(!1),!0))).subscribe()}};k.\u0275fac=function(a){return new(a||k)(e.Y36(o.qBz),e.Y36(o.KDu),e.Y36(m._M),e.Y36(H.uw),e.Y36(ee.GiveawayService),e.Y36(N.LoginService),e.Y36(ae.RouletteService),e.Y36(me.zM),e.Y36(o.Pb3))},k.\u0275cmp=e.Xpm({type:k,selectors:[["cw-message"]],hostBindings:function(a,t){1&a&&e.NdJ("mouseleave",function(){return t.onMouseleave()})},inputs:{message:"message"},decls:5,vars:2,consts:function(){let n,a,t,i,c,u,f,E,P,G,T,W,Ne,Y,ne,Pe,Ge,Ae,ve;return n=$localize`:␟994363f08f9fbfa3b3994ff7b35c6904fdff18d8␟4915431133669985304:Profile`,a=$localize`:␟59a3f43d5c735c74b6ea9b243a39eb9eee2c31b4␟1446710878173113225:Delete All`,t=$localize`:␟826b25211922a1b46436589233cb6f1a163d89b7␟7022070615528435141:Delete`,i=$localize`:␟7be9877f3b1042bfc095c728acb0dbeb9c6e8205␟2494293689061559568:Mute`,c=$localize`:␟bb48951f3cbaf9280529b2171a53bcedc942704f␟3191730437680727695:Mute for how long?`,u=$localize`:␟f10b143da61bdbeb6b7396fc0e4bcf132abbac37␟5332350867129241974:5m`,f=$localize`:␟737b387b6c91f80617283fc4a011dd3a982efb2b␟9184963060275130414:1h`,E=$localize`:␟1ff6e4e98d5b1bee68f14d93facacb7daea5ea00␟3312860774260166080:1d`,P=$localize`:␟f7b50e4989540954a9035833470efba042a2819c␟176275557076409837:1w`,G=$localize`:␟d1d5e74245d6d315a782161b7765171516148ccc␟2623715199667809501:1y`,T=$localize`:␟5596283f2caaab05fdbdb160425984984819e61e␟6018571751257181414: First green, it's a signal. Get ready for the ${"\ufffd0\ufffd"}:INTERPOLATION:${"\ufffd#4\ufffd"}:START_TAG_CW_PRETTY_BALANCE:${"\ufffd/#4\ufffd"}:CLOSE_TAG_CW_PRETTY_BALANCE: jackpot `,W=$localize`:␟50a4b5ed79d46c2bd4aa72ae2536cdad9de09f8e␟783506798863502840: Double green, now we're talking! Here's your chance for the ${"\ufffd0\ufffd"}:INTERPOLATION:${"\ufffd#4\ufffd"}:START_TAG_CW_PRETTY_BALANCE:${"\ufffd/#4\ufffd"}:CLOSE_TAG_CW_PRETTY_BALANCE: jackpot `,Ne=$localize`:␟7783019a1ef594a3173d0309325320f8382fa833␟4403893093663981665:${"\ufffd#3\ufffd"}:START_TAG_CW_PRETTY_BALANCE:${"\ufffd/#3\ufffd"}:CLOSE_TAG_CW_PRETTY_BALANCE: ${"\ufffd0\ufffd"}:INTERPOLATION: won on the Triple Green Jackpot `,Y=$localize`:␟f234922fa515abd1c1431d2c8e8fb0bceba51a36␟8031123790936841435:${"\ufffd#3\ufffd"}:START_LINK:${"\ufffd0\ufffd"}:INTERPOLATION:${"\ufffd/#3\ufffd"}:CLOSE_LINK: won ${"\ufffd#4\ufffd"}:START_TAG_CW_PRETTY_BALANCE:${"\ufffd/#4\ufffd"}:CLOSE_TAG_CW_PRETTY_BALANCE: from the Jackpot! `,ne=$localize`:␟ae91e4843895ca90a36c0fa486775a06b7d5719c␟2758699667184109314: ${"\ufffd0\ufffd"}:INTERPOLATION: for  ${"\ufffd#2\ufffd"}:START_TAG_CW_WALLET_BALANCE:${"\ufffd/#2\ufffd"}:CLOSE_TAG_CW_WALLET_BALANCE:  will start in ${"\ufffd1\ufffd"}:INTERPOLATION_1: minutes. `,Pe=$localize`:␟6e5974b6476d8880f046acca49a794938a034230␟8062758768243577090: ${"\ufffd0\ufffd"}:INTERPOLATION: for  ${"\ufffd#3\ufffd"}:START_TAG_CW_WALLET_BALANCE:${"\ufffd/#3\ufffd"}:CLOSE_TAG_CW_WALLET_BALANCE:  has started. `,Ge=$localize`:␟2e522671010400ab88ebf47bc2c3d39ed89e0a6a␟3873679372054706939:Join Drop Party`,Ae=$localize`:␟f41cc439f2ddba5173becd8871b7721620761cff␟7180703008510765266:${"\ufffd*2:1\ufffd\ufffd#1:1\ufffd"}:START_TAG_NG_CONTAINER: ${"\ufffd0:1\ufffd"}:INTERPOLATION: unboxed ${"\ufffd1:1\ufffd"}:INTERPOLATION_1: and won a ${"[\ufffd2:1\ufffd|\ufffd2:2\ufffd]"}:INTERPOLATION_2:X ${"[\ufffd3:1\ufffd|\ufffd3:2\ufffd]"}:INTERPOLATION_3: boost for Team ${"[\ufffd4:1\ufffd|\ufffd0:2\ufffd]"}:INTERPOLATION_4:! ${"\ufffd/#1:1\ufffd\ufffd/*2:1\ufffd"}:CLOSE_TAG_NG_CONTAINER:${"\ufffd*3:2\ufffd"}:START_TAG_NG_TEMPLATE: Team ${"[\ufffd4:1\ufffd|\ufffd0:2\ufffd]"}:INTERPOLATION_4: has collected ${"\ufffd#1:2\ufffd"}:START_TAG_CW_GEMSTONE_BALANCE:${"\ufffd/#1:2\ufffd"}:CLOSE_TAG_CW_GEMSTONE_BALANCE:${"\ufffd1:2\ufffd"}:INTERPOLATION_5: and activated ${"[\ufffd2:1\ufffd|\ufffd2:2\ufffd]"}:INTERPOLATION_2:X ${"[\ufffd3:1\ufffd|\ufffd3:2\ufffd]"}:INTERPOLATION_3: boost! ${"\ufffd/*3:2\ufffd"}:CLOSE_TAG_NG_TEMPLATE:`,Ae=e.Zx4(Ae),ve=$localize`:␟ffeead5fc0ec9c90383dec523ccfb924a8031886␟2234730102448686936:${"\ufffd#2\ufffd"}:START_LINK:${"\ufffd0\ufffd"}:INTERPOLATION:${"[\ufffd/#2\ufffd|\ufffd/#1:2\ufffd\ufffd/*5:2\ufffd]"}:CLOSE_LINK: won ${"\ufffd1\ufffd"}:INTERPOLATION_1:${"\ufffd#3\ufffd"}:START_TAG_CW_PRETTY_BALANCE:${"\ufffd/#3\ufffd"}:CLOSE_TAG_CW_PRETTY_BALANCE: from ${"\ufffd*4:1\ufffd\ufffd#1:1\ufffd"}:START_TAG_SPAN:${"\ufffd#2:1\ufffd"}:START_TAG_STRONG:${"\ufffd0:1\ufffd"}:INTERPOLATION_2:${"\ufffd/#2:1\ufffd"}:CLOSE_TAG_STRONG: during a PVP Duel ${"\ufffd/#1:1\ufffd\ufffd/*4:1\ufffd"}:CLOSE_TAG_SPAN:${"\ufffd*5:2\ufffd\ufffd#1:2\ufffd"}:START_LINK_1: ${"\ufffd0:2\ufffd"}:INTERPOLATION_3: ${"[\ufffd/#2\ufffd|\ufffd/#1:2\ufffd\ufffd/*5:2\ufffd]"}:CLOSE_LINK:${"\ufffd*6:3\ufffd"}:START_TAG_NG_TEMPLATE:${"\ufffd0:3\ufffd"}:INTERPOLATION_4:${"\ufffd/*6:3\ufffd"}:CLOSE_TAG_NG_TEMPLATE:`,ve=e.Zx4(ve),[["class","message",4,"ngIf","ngIfElse"],["houseMessage",""],["boxOpeningTpl",""],[1,"message"],["class","flare-border",3,"background-color",4,"ngIf"],[1,"main"],[1,"body","d-flex","align-items-end"],["class","avatar rounded-circle mr-1",3,"routerLink","click",4,"ngIf"],[1,"min-w-0"],[1,"name"],["class","flare",3,"color",4,"ngIf"],[1,"value","ellipsis"],["class","btn-menu",3,"click",4,"ngIf"],[1,"user-message-container","mt-1"],[1,"user-message"],["class","menu",3,"ngSwitch",4,"ngIf"],[1,"flare-border"],[1,"avatar","rounded-circle","mr-1",3,"routerLink","click"],[3,"user","small","authenticBadge",4,"ngIf"],["class","user-img",3,"src",4,"ngIf"],[3,"user","small","authenticBadge"],[1,"user-img",3,"src"],[1,"flare"],[1,"btn-menu",3,"click"],[1,"menu",3,"ngSwitch"],["class","menu-items",4,"ngSwitchDefault"],[4,"ngSwitchCase"],[1,"menu-items"],["class","menu-item",3,"click",4,"ngIf"],[1,"menu-item",3,"routerLink"],["inlineSVG","assets/icons/users.svg"],n,[1,"menu-item",3,"click"],["inlineSVG","assets/icons/close.svg"],a,t,["inlineSVG","assets/icons/audio.svg"],i,[1,"mb-2"],c,[1,"menu-item"],["mat-stroked-button","","type","button",3,"click"],u,f,E,P,G,[1,"body"],["fxLayout","column","fxLayoutGap","0.35rem",1,"user-message-container"],[1,"logo"],["loading","lazy",3,"src"],[1,"brand"],[1,"message-container"],[4,"ngIf"],[1,"user-message",3,"ngSwitch"],[4,"ngSwitchDefault"],[3,"user",4,"ngIf"],[3,"user"],["fxLayout","column","fxLayoutGap",".5rem"],T,[3,"balance","currency"],["mat-flat-button","","color","accent",3,"routerLink"],W,["placement","top",1,"pointer",3,"ngbTooltip","click"],Ne,[4,"ngTemplateOutlet","ngTemplateOutletContext"],Y,[3,"routerLink"],ne,[3,"balance","currency","walletType"],Pe,["mat-flat-button","","color","accent",1,"w-100",3,"click"],[3,"loading"],Ge,[1,"mb-3"],["class","d-flex flex-row align-items-center w-100 mb-1",4,"ngFor","ngForOf"],[1,"d-flex","flex-row","align-items-center","w-100","mb-1"],[1,"pointer",3,"user","routerLink"],[1,"px-2","ellipsis","text-center"],[1,"flex-grow-1","text-right",3,"balance","currency","walletType"],Ae,[4,"ngIf","ngIfElse"],["points",""],["imgHeight","0.75em",3,"balance"],ve,["mat-flat-button","","color","primary",3,"routerLink",4,"ngIf","ngIfElse"],["boxName",""],["mat-flat-button","","color","primary",3,"routerLink"]]},template:function(a,t){if(1&a&&(e.YNc(0,ke,15,7,"article",0),e.YNc(1,ht,29,24,"ng-template",null,1,e.W1O),e.YNc(3,wt,1,1,"ng-template",null,2,e.W1O)),2&a){const i=e.MAs(2);e.Q6J("ngIf",t.user)("ngIfElse",i)}},directives:[h.O5,Fe.yS,we.i,h.RF,h.ED,h.n9,de.o,Te.d$,$.lW,Ce.xw,Ce.SQ,se.q,$.zs,fe._L,h.tP,Me.f,ue.R,h.sg,Fe.rH,De.P],pipes:[Se.d,h.Ov,Ie.n,V.O,_,h.JJ,l.c,C.f],styles:['[_nghost-%COMP%]{font-size:.9rem;z-index:1}[_nghost-%COMP%]:hover   .btn-menu[_ngcontent-%COMP%]{opacity:1}.main[_ngcontent-%COMP%]{border-bottom-color:none}.created-at[_ngcontent-%COMP%]{color:#fffc;font-weight:400}.header[_ngcontent-%COMP%]{color:#fff}.avatar[_ngcontent-%COMP%]{background-color:transparent}.level[_ngcontent-%COMP%]{background:var(--chat-message-level-bg);color:var(--chat-message-level)}@media (hover: none){[_nghost-%COMP%]   .btn-menu[_ngcontent-%COMP%]{opacity:1}}.message[_ngcontent-%COMP%]{position:relative;display:flex}.flare-border[_ngcontent-%COMP%]{content:"";position:absolute;top:.05rem;left:0;bottom:.05rem;width:4px}.main[_ngcontent-%COMP%]{width:100%;flex:1;padding:.5rem 0;border-bottom:1px solid transparent}.flare[_ngcontent-%COMP%]{font-weight:500;margin-right:.25rem;white-space:nowrap}.name[_ngcontent-%COMP%]{display:flex;align-items:center;color:var(--message-name-color, var(--body-color))}.verified-icon[_ngcontent-%COMP%]{vertical-align:text-top}.btn-menu[_ngcontent-%COMP%]{position:absolute;top:0;right:0;border:0;outline:none;background:none;opacity:0;cursor:pointer;color:inherit}.who-when[_ngcontent-%COMP%]{flex:1;overflow:hidden;line-height:1.4}.created-at[_ngcontent-%COMP%]{display:flex;font-size:.5rem;margin-bottom:.2rem}.avatar[_ngcontent-%COMP%]{margin:0 .5rem 0 0}.img[_ngcontent-%COMP%]{width:100%;height:100%;border-radius:50%;background-repeat:no-repeat;background-size:100%}.level[_ngcontent-%COMP%]{margin:0 .5rem 0 0;min-width:1.8rem;padding:.2rem .5rem;font-size:.75rem;font-weight:500;line-height:1;border-radius:.25rem;text-align:center}.body[_ngcontent-%COMP%]{font-size:.8rem;word-wrap:break-word;word-break:break-word}.message-container[_ngcontent-%COMP%]{display:flex;align-items:flex-start}.message-container[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]{margin-top:.5rem}.message-container[_ngcontent-%COMP%]   .mat-flat-button[_ngcontent-%COMP%]{width:100%;margin-top:.3rem}.user-message[_ngcontent-%COMP%]{width:100%;border-radius:10px 10px 10px 0;background:var(--user-message-bg-color);opacity:.8;color:var(--user-message-color);padding:.75rem}.user-message[_ngcontent-%COMP%]     cw-pretty-balance{color:#00c74d}.menu[_ngcontent-%COMP%]{position:absolute;top:0;right:0;bottom:0;left:0;display:flex;flex-direction:column;justify-content:center;text-align:center;z-index:20;background:var(--user-message-bg-color)}.menu-items[_ngcontent-%COMP%]{display:flex;justify-content:space-around;align-items:center}.menu-item[_ngcontent-%COMP%]{text-align:center;cursor:pointer;font-size:.75rem}.menu-item[_ngcontent-%COMP%]   cw-icon[_ngcontent-%COMP%]{width:1.5rem;height:1.5rem}.menu-item[_ngcontent-%COMP%]:hover{text-decoration:none}.menu-item[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:.5rem;min-width:unset;line-height:unset!important}a[_ngcontent-%COMP%]{text-decoration:none}.user-img[_ngcontent-%COMP%]{border-radius:50%;height:20px;width:20px}.logo[_ngcontent-%COMP%]{width:3rem;margin-right:.5rem}.logo[_ngcontent-%COMP%]     img{width:100%}.brand[_ngcontent-%COMP%]{color:#de4c41}'],changeDetection:0}),k=(0,x.gn)([(0,F.c)(),(0,x.w6)("design:paramtypes",[Object,o.KDu,m._M,H.uw,ee.GiveawayService,N.LoginService,ae.RouletteService,me.zM,o.Pb3])],k);const Dt=R.Ps`
  query MessageList($channel: String!, $userId: ID, $last: PaginationAmount, $before: String) {
    messages(channel: $channel, userId: $userId, last: $last, before: $before) {
      pageInfo {
        hasPreviousPage
        endCursor
      }
      edges {
        node {
          ...Message
        }
      }
    }
  }

  ${ge}
`,be=R.Ps`
  query CachedMessageList($channels: [String], $first: PaginationAmount) {
    messages: cachedMessages(channels: $channels, first: $first) {
      edges {
        node {
          ...Message
        }
      }
    }
  }

  ${ge}
`,It=R.Ps`
  subscription OnCreateMessage($channel: String!) {
    createMessage(channel: $channel) {
      message {
        ...Message
      }
    }
  }

  ${ge}
`,bt=R.Ps`
  subscription OnDeleteMessage($channel: String!) {
    deleteMessage(channel: $channel) {
      message {
        id
      }
    }
  }
`;var Lt=s(2658),Nt=s(90224),ce=(()=>{return(n=ce||(ce={})).CREATED="CREATED",n.COMPLETED="COMPLETED",n.ENDED="ENDED",n.STARTED="STARTED",ce;var n})(),he=(()=>{return(n=he||(he={})).COMPLETED_AT="COMPLETED_AT",n.COMPLETED_AT_DESC="COMPLETED_AT_DESC",n.CREATED_AT="CREATED_AT",n.CREATED_AT_DESC="CREATED_AT_DESC",n.END_AT="END_AT",n.END_AT_DESC="END_AT_DESC",n.ID="ID",n.ID_DESC="ID_DESC",n.START_AT="START_AT",n.START_AT_DESC="START_AT_DESC",he;var n})();function $t(n,a){if(1&n&&(e.TgZ(0,"div"),e._uU(1," It's drop party time! Join now for a chance to win "),e._UZ(2,"cw-wallet-balance",8),e.qZA()),2&n){const t=a.ngIf,i=e.oxw(2).$implicit;e.xp6(2),e.Q6J("balance",t)("currency",i.currency)("walletType",i.walletType)}}function Pt(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"h5"),e._uU(2),e.qZA(),e.YNc(3,$t,3,3,"div",4),e.TgZ(4,"button",5),e.NdJ("click",function(){e.CHM(t);const c=e.oxw().$implicit;return e.oxw().joinGiveaway(c.id)}),e.TgZ(5,"cw-loader",6),e.SDv(6,7),e.ALo(7,"asyncInner"),e.qZA(),e.qZA(),e.BQk()}if(2&n){const t=e.oxw().$implicit,i=e.oxw();e.xp6(2),e.Oqu(t.name),e.xp6(1),e.Q6J("ngIf",t.rewardAmount/t.winnersAmount),e.xp6(2),e.Q6J("loading",e.lcZ(7,3,i.loadingChange$))}}function Gt(n,a){if(1&n&&(e.ynx(0),e._uU(1),e.TgZ(2,"span",9),e._uU(3),e.qZA(),e._uU(4," and won "),e._UZ(5,"cw-wallet-balance",8),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.totalEntries," users participated in "),e.xp6(2),e.Oqu(t.name),e.xp6(2),e.Q6J("balance",t.rewardAmount)("currency",t.currency)("walletType",t.walletType)}}function Bt(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",1),e.TgZ(1,"cw-icon",2),e.NdJ("click",function(){const u=e.CHM(t).$implicit;return e.oxw().hide(u)}),e.qZA(),e.YNc(2,Pt,8,5,"ng-container",3),e.YNc(3,Gt,6,5,"ng-container",3),e.qZA()}if(2&n){const t=a.$implicit,i=e.oxw();e.Q6J("ngSwitch",t.status),e.xp6(2),e.Q6J("ngSwitchCase",i.GiveawayStatus.STARTED),e.xp6(1),e.Q6J("ngSwitchCase",i.GiveawayStatus.COMPLETED)}}let Zt=(()=>{class n extends((0,X.A)(X.t)){constructor(t,i,c){super(),this.apollo=t,this.giveawayService=i,this.loginService=c,this.hiddenCollection=new o.Vnp([]),this.loadingChange=new Z.x,this.subscription=new re.w0,this.loadingChange$=this.loadingChange.asObservable().pipe((0,L.O)(!1)),this.GiveawayStatus=ce,this.WalletName=r.w}ngOnInit(){const t=[ce.STARTED];this.giveawaysQuery=this.apollo.watchQuery({query:ee.giveawayConnectionQuery,fetchPolicy:"cache-and-network",variables:{first:1,statuses:t,orderBy:he.ID_DESC}});const i=this.giveawaysQuery.valueChanges.pipe((0,w.U)(({data:c})=>c?c.giveaways.edges.map(u=>u.node):[]));this.giveaways$=(0,K.a)([i,this.hiddenCollection.items$]).pipe((0,w.U)(([c,u])=>c.filter(f=>!(u.find(E=>E===f.id)||f.status===ce.STARTED&&new Date(f.endAt)<new Date)&&t.includes(f.status)).slice(-1))),this.subscription.add(this.giveawaysQuery.subscribeToMore({document:ee.giveawayUpdatedSubscription,updateQuery:(c,{subscriptionData:u})=>{var f,E;return this.giveawayService.addToResponse(c,null===(E=null===(f=u.data)||void 0===f?void 0:f.updateGiveaway)||void 0===E?void 0:E.giveaway)}}))}ngOnDestroy(){this.subscription.unsubscribe()}joinGiveaway(t){return this.loadingChange.next(!0),this.loginService.openLoginIfNoUser().pipe((0,q.w)(()=>this.giveawayService.join(t,()=>this.loadingChange.next(!1),!0)),(0,S.q)(1)).subscribe()}hide(t){this.hiddenCollection.add(t.id)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(m._M),e.Y36(ee.GiveawayService),e.Y36(N.LoginService))},n.\u0275cmp=e.Xpm({type:n,selectors:[["cw-giveaway-message-list"]],features:[e.qOj],decls:2,vars:4,consts:function(){let a;return a=$localize`:␟15398a3af4523f04f1e102c48272e6b7c4b495b9␟5596845383659202417:Join Giveaway`,[["class","message mb-2",3,"ngSwitch",4,"ngFor","ngForOf","ngForTrackBy"],[1,"message","mb-2",3,"ngSwitch"],["inlineSVG","assets/icons/close-circle.svg",3,"click"],[4,"ngSwitchCase"],[4,"ngIf"],["mat-flat-button","","color","accent",1,"w-100",3,"click"],[3,"loading"],a,[3,"balance","currency","walletType"],[1,"font-weight-"]]},template:function(t,i){1&t&&(e.YNc(0,Bt,4,3,"div",0),e.ALo(1,"async")),2&t&&e.Q6J("ngForOf",e.lcZ(1,2,i.giveaways$))("ngForTrackBy",i.trackById)},directives:[h.sg,h.RF,de.o,Te.d$,h.n9,h.O5,$.lW,ue.R,Me.f],pipes:[h.Ov,Se.d],styles:[".message[_ngcontent-%COMP%]{position:relative;border-radius:10px 10px 10px 0;background:#292e35;color:var(--user-message-color);opacity:.8;padding:.75rem}.message[_ngcontent-%COMP%]    >button{margin-top:.75rem}.message[_ngcontent-%COMP%]     cw-pretty-balance, .message[_ngcontent-%COMP%]     cw-gemstone-balance{color:#00c74d}cw-icon[_ngcontent-%COMP%]{position:absolute;right:.375rem;top:.375rem;width:1em}"],changeDetection:0}),n})();var Le;const Rt=["listView"];function Qt(n,a){1&n&&e._UZ(0,"cw-message",7),2&n&&e.Q6J("message",a.$implicit)}function Jt(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",8),e.TgZ(1,"button",9),e.NdJ("click",function(){return e.CHM(t),e.oxw().onScrollToBottom()}),e.SDv(2,10),e.qZA(),e.qZA()}if(2&n){const t=a.ngIf;e.Q6J("@newMsgBtnEnterAnim",void 0)("@newMsgBtnLeaveAnim",void 0),e.xp6(2),e.pQV(t),e.QtT(2)}}var J=(()=>{return(n=J||(J={})).TOP="TOP",n.BOTTOM="BOTTOM",n.FORCE_BOTTOM="FORCE_BOTTOM",J;var n})();let te=Le=class extends((0,X.A)(X.t)){constructor(a,t,i){super(),this.apollo=a,this.appNotificationsService=t,this.userService=i,this.channel="en",this.limit=20,this.renderLimit=100,this.cached=!1,this.messagesViewChildren$=new U.X([]),this.isFirstFetch$=new U.X(!0),this.firstElement=null,this.isFetchingMore$=new U.X(!1),this.pageInfo={hasPreviousPage:!0,endCursor:null},this.forceBottomScroll$=new U.X(!1),this.subscription=new re.w0,this.delayedMessage$=new Z.x,this.userProgress$=this.userService.userProgress$}get listViewEl(){return this.listView.nativeElement}get offsetFromTop(){return this.listViewEl.scrollTop}get offsetFromBottom(){return Math.max(Math.abs(this.listViewEl.scrollHeight-this.listViewEl.scrollTop-this.listViewEl.clientHeight)-50,0)}scrollToEl(a,t){null==a||a.scrollIntoView(t)}ngOnInit(){this.scrollTime$=(0,b.R)(this.listViewEl,"scroll").pipe((0,L.O)(0),(0,w.U)(()=>Date.now()),(0,le.e)(100)),this.stuckToBottom$=this.scrollTime$.pipe((0,L.O)(0),(0,w.U)(()=>this.offsetFromBottom),(0,w.U)(t=>0===t),(0,z.x)(),(0,D.b)(()=>this.timeStuckToBottom=Date.now())),this.messagesQuery=this.apollo.watchQuery(this.cached?{query:be,variables:{channels:[this.channel],first:this.limit}}:{query:Dt,variables:{userId:this.userId,channel:this.channel,last:this.limit,before:this.pageInfo.endCursor}}),this.messages$=this.messagesQuery.valueChanges.pipe((0,w.U)(({data:t})=>{if(!t)return[];this.pageInfo=t.messages.pageInfo;const i=(t=>t.filter(i=>{const{type:c}=i||{};return!c||Le.ALLOWED_MESSAGE_TYPES.includes(c)}))(t.messages.edges.map(c=>c.node));return this.cached?i.reverse():i}),(0,_e.B)()),this.newMessagesAmount$=(0,K.a)([this.messages$,this.stuckToBottom$]).pipe((0,oe.M)(this.stuckToBottom$),(0,w.U)(([[t],i])=>i?0:t.filter(c=>new Date(c.createdAt)>new Date(this.timeStuckToBottom)).length)),this.viewMessages$=(0,K.a)([this.messages$,this.scrollTime$,this.forceBottomScroll$.asObservable()]).pipe((0,F.t)(this),(0,q.w)(([t,,i])=>{const c=this.messagesComponents.toArray().map(T=>T.messageId),[u]=c,f=c[c.length-1],E=t.findIndex(T=>T.id===u),P=t.findIndex(T=>T.id===f);if(E<0&&P<0)return(0,g.of)(t);const G=T=>{if(!(t.length>=this.renderLimit))return t;if(T===J.TOP){const Y=Math.max(E-this.renderLimit+20,0),ne=Math.min(Y+this.renderLimit,t.length);return t.slice(Y,ne)}if(T===J.BOTTOM){const Y=Math.max(P-20,0),ne=Math.min(Y+this.renderLimit,t.length);return t.slice(Y,ne)}if(T===J.FORCE_BOTTOM){const Y=Math.max(t.length-this.renderLimit,0);return t.slice(Y,t.length)}};return i?(0,g.of)(G(J.FORCE_BOTTOM)).pipe((0,D.b)(()=>{this.forceBottomScroll$.next(!1),this.handleScroll().subscribe()})):0===E&&this.offsetFromTop<50?(0,g.of)(G(J.TOP)).pipe((0,O.h)(()=>!this.isFetchingMore$.getValue()),(0,D.b)(()=>{if(this.fetchMore(),!this.isFirstFetch$.getValue()){const{visibleFirst:T}=this.getCurrentlyVisibleMessages();this.handleScrollAfterFetch(T.nativeElement,{block:"start"}).subscribe()}})):E>0&&this.offsetFromTop<100?(0,g.of)(G(J.TOP)).pipe((0,D.b)(()=>{const{visibleFirst:T}=this.getCurrentlyVisibleMessages();this.handleScrollAfterFetch(T.nativeElement,{block:"start"}).subscribe()})):P<t.length-1&&this.offsetFromBottom<100?(0,g.of)(G(J.BOTTOM)).pipe((0,D.b)(()=>{const{visibleLast:T}=this.getCurrentlyVisibleMessages();T&&this.handleScrollAfterFetch(T.nativeElement,{block:"center"}).subscribe()})):(0,g.of)(t)}),(0,z.x)((t,i)=>t.length>0&&JSON.stringify(t.map(c=>c.id))===JSON.stringify(i.map(c=>c.id))),(0,D.b)(()=>this.messagesViewChildren$.next([]))),this.subscribeToCreates(),this.subscribeToDeletes()}ngAfterViewInit(){this.handleScrollToBottom().subscribe(),this.messagesViewChildren.changes.pipe((0,F.t)(this),(0,D.b)(a=>{this.messagesViewChildren$.next(a.toArray())})).subscribe(),this.fetchMore()}handleScrollToBottom(){return(0,K.a)([this.messages$,this.userService.user$,(0,b.R)(document,"visibilitychange").pipe((0,L.O)(0),(0,O.h)(()=>!document.hidden))]).pipe((0,F.t)(this),(0,oe.M)(this.stuckToBottom$),(0,q.w)(([[a,t],i])=>{var c;const u=a[a.length-1],f=(null==t?void 0:t.id)&&t.id===(null===(c=null==u?void 0:u.user)||void 0===c?void 0:c.id)&&new Date(u.createdAt)>new Date(Date.now()-3e3);return i||f?this.handleScroll():p.E}),(0,M.l)())}ngOnDestroy(){this.subscription.unsubscribe()}subscribeToCreates(){this.subscription.add(this.messagesQuery.subscribeToMore({document:It,variables:{channel:this.channel},updateQuery:(a,{subscriptionData:t})=>{if(!t.data||!a.messages)return a;const i=t.data.createMessage.message,c={__typename:"MessageEdge",node:i},u=this.appNotificationsService.getDelay(o.xCK.MESSAGE_BOX_OPENING);return i.type===d.C.BOX_OPENING&&i.meta.user.id===this.userId&&u?(u.pipe((0,S.q)(1),(0,F.t)(this)).subscribe(()=>{const f=this.apollo.getClient(),E={channels:[this.channel],first:this.limit},P=f.readQuery({query:be,variables:E}),G={edges:[c,...P.messages.edges],__typename:"MessageConnection"},T=Object.assign(Object.assign({},P),{messages:G});f.writeQuery({query:be,data:T,variables:E})}),a):Object.assign(Object.assign({},a),{messages:Object.assign(Object.assign({},a.messages),{edges:[c,...a.messages.edges.slice(0,100)]})})}}))}subscribeToDeletes(){this.subscription.add(this.messagesQuery.subscribeToMore({document:bt,variables:{channel:this.channel},updateQuery:(a,{subscriptionData:t})=>{const i=t.data.deleteMessage.message.id,c=a.messages.edges.filter(u=>u.node.id!==i);return Object.assign(Object.assign({},a),{messages:Object.assign(Object.assign({},a.messages),{edges:c})})}}))}fetchMore(){!this.cached&&this.pageInfo.hasPreviousPage&&(this.isFetchingMore$.next(!0),this.messagesQuery.fetchMore({variables:{before:this.pageInfo.endCursor}}).finally(()=>{this.isFetchingMore$.next(!1)}))}handleScroll(){return this.messagesViewChildren.changes.pipe((0,F.t)(this),(0,w.U)(({_results:a})=>a),(0,y.P)(a=>!!a.length),(0,D.b)(a=>{this.isFirstFetch$.getValue()&&this.isFirstFetch$.next(!1);const{nativeElement:t}=a[a.length-1];this.scrollToEl(t,{block:"center"})}),(0,M.l)())}onScrollToBottom(){this.forceBottomScroll$.next(!0)}handleScrollAfterFetch(a,t){return this.messagesViewChildren.changes.pipe((0,y.P)(),(0,F.t)(this),(0,D.b)(()=>this.scrollToEl(a,t)),(0,M.l)())}getCurrentlyVisibleMessages(a=this.messagesViewChildren$.getValue()){const t=a.filter(({nativeElement:i})=>{const{bottom:c,y:u}=i.getBoundingClientRect();return c<window.innerHeight&&u>25});return t.length>0?{visibleFirst:t[0],visibleLast:t[t.length-1]}:{visibleFirst:null,visibleLast:null}}};te.ALLOWED_MESSAGE_TYPES=[d.C.BOX_OPENING,d.C.PVP_BOX_GAME_BIG_WIN,d.C.GAME_JACKPOT_1X,d.C.GAME_JACKPOT_2X,d.C.GAME_JACKPOT_3X,d.C.GEMSTONE_BOOST_ACTIVATION_CREATED,d.C.GEMSTONE_BOX_WIN,d.C.GIVEAWAY_CREATED,d.C.GIVEAWAY_STARTED,d.C.GIVEAWAY_COMPLETED,d.C.JACKPOT_TICKET_WIN],te.\u0275fac=function(a){return new(a||te)(e.Y36(m._M),e.Y36(o.n1p),e.Y36(o.KDu))},te.\u0275cmp=e.Xpm({type:te,selectors:[["cw-message-list"]],viewQuery:function(a,t){if(1&a&&(e.Gf(Rt,7),e.Gf(k,5,e.SBq),e.Gf(k,5)),2&a){let i;e.iGM(i=e.CRH())&&(t.listView=i.first),e.iGM(i=e.CRH())&&(t.messagesViewChildren=i),e.iGM(i=e.CRH())&&(t.messagesComponents=i)}},inputs:{channel:"channel",limit:"limit",renderLimit:"renderLimit",userId:"userId",cached:"cached"},features:[e.qOj],decls:13,vars:13,consts:function(){let n;return n=$localize`:␟a7f51a73feb37ef98d2f96fde5a6b7c689178581␟7384600734057451706: ${"\ufffd0\ufffd"}:INTERPOLATION: New Message(s) `,[[3,"userProgress"],[1,"text-center"],[3,"loading"],[1,"list","pretty-scrollbar"],["listView",""],["class","list-item",3,"message",4,"ngFor","ngForOf","ngForTrackBy"],["class","new-messages-button-container",4,"ngIf"],[1,"list-item",3,"message"],[1,"new-messages-button-container"],["mat-flat-button","","color","dark",1,"mat-button-round","new-messages-button",3,"click"],n]},template:function(a,t){1&a&&(e._UZ(0,"cw-gemstone-boost-info"),e._UZ(1,"cw-xp-boost-info",0),e.ALo(2,"async"),e.TgZ(3,"div",1),e._UZ(4,"cw-loader",2),e.ALo(5,"async"),e.qZA(),e.TgZ(6,"div",3,4),e.YNc(8,Qt,1,1,"cw-message",5),e.ALo(9,"async"),e.qZA(),e._UZ(10,"cw-giveaway-message-list"),e.YNc(11,Jt,3,3,"div",6),e.ALo(12,"async")),2&a&&(e.xp6(1),e.Q6J("userProgress",e.lcZ(2,5,t.userProgress$)),e.xp6(3),e.Q6J("loading",!0===e.lcZ(5,7,t.isFetchingMore$)),e.xp6(4),e.Q6J("ngForOf",e.lcZ(9,9,t.viewMessages$))("ngForTrackBy",t.trackById),e.xp6(3),e.Q6J("ngIf",e.lcZ(12,11,t.newMessagesAmount$)))},directives:[Lt.R,Nt.G,ue.R,h.sg,Zt,h.O5,k,$.lW],pipes:[h.Ov],styles:[".no-scrollbar[_ngcontent-%COMP%]{scrollbar-width:none;-ms-overflow-style:none}.no-scrollbar[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}[_nghost-%COMP%]{display:flex;flex-direction:column;position:relative;overflow:hidden}.list[_ngcontent-%COMP%]{overflow-y:scroll;overflow-x:auto;overscroll-behavior-y:none;flex:1;padding-right:15px;margin-right:-5px}.new-messages-button-container[_ngcontent-%COMP%]{position:absolute;right:0;bottom:2rem;left:0;display:flex;align-items:center;justify-content:center}.new-messages-button[_ngcontent-%COMP%]{text-transform:uppercase;font-size:.7rem}cw-gemstone-boost-info[_ngcontent-%COMP%]{margin:0 -1rem}cw-xp-boost-info[_ngcontent-%COMP%]{margin:0 -1rem}"],data:{animation:[(0,j.qd)({anchor:"newMsgBtnEnterAnim",duration:300,translate:"50%"}),(0,j.dH)({anchor:"newMsgBtnLeaveAnim",duration:300,translate:"50%"})]},changeDetection:0}),te=Le=(0,x.gn)([(0,F.c)(),(0,x.w6)("design:paramtypes",[m._M,o.n1p,o.KDu])],te)},54530:(xe,B,s)=>{s.r(B),s.d(B,{GemstoneBoostHowItWorksModalComponent:()=>x.c,TeamSelectDialogComponent:()=>e.h,GemstoneSharedModule:()=>o.S});var x=s(78488),e=s(53079),o=s(8639)},9772:(xe,B,s)=>{s.r(B),s.d(B,{GiveawayModule:()=>L,GiveawayService:()=>q,giveawayConnectionQuery:()=>X,giveawayFragment:()=>o,giveawayUpdatedSubscription:()=>d,joinGiveawayMutation:()=>e});var x=s(39478);const e=x.Ps`
  mutation JoinGiveaway($input: JoinGiveawayInput!) {
    joinGiveaway(input: $input) {
      userGiveaway {
        id
        giveaway {
          id
          name
        }
      }
    }
  }
`,o=x.Ps`
  fragment Giveaway on Giveaway {
    id
    name
    status
    createdAt
    startAt
    endAt
    completedAt
    rewardAmount
    winnersAmount
    currency
    walletType
    totalEntries
  }
`,X=x.Ps`
  query GiveawayConnectionQuery(
    $after: String
    $before: String
    $first: PaginationAmount
    $last: PaginationAmount
    $orderBy: [GiveawayOrderBy]
    $statuses: [GiveawayStatus!]
  ) {
    giveaways(after: $after, before: $before, first: $first, last: $last, orderBy: $orderBy, statuses: $statuses) {
      pageInfo {
        hasNextPage
        endCursor
      }
      edges {
        node {
          ...Giveaway
        }
      }
    }
  }
  ${o}
`,d=x.Ps`
  subscription GiveawayUpdated {
    updateGiveaway {
      giveaway {
        ...Giveaway
      }
    }
  }

  ${o}
`;var F=s(35357),j=s(23600),m=s(5e3),U=s(22313);const Z=[{path:"",component:(()=>{class g{constructor(p,M,S,y){this.appConfig=p,this.domSanitizer=M,this.route=S,this.router=y}ngOnInit(){return this.appConfig.gleam?this.src=this.domSanitizer.bypassSecurityTrustResourceUrl(this.appConfig.gleam.url):this.router.navigate([".."],{relativeTo:this.route})}}return g.\u0275fac=function(p){return new(p||g)(m.Y36(j.qBz),m.Y36(U.H7),m.Y36(F.gz),m.Y36(F.F0))},g.\u0275cmp=m.Xpm({type:g,selectors:[["cw-gleam-provider"]],decls:2,vars:1,consts:[[1,"gleam"],["allowfullscreen","true","frameborder","0",3,"src"]],template:function(p,M){1&p&&(m.TgZ(0,"div",0),m._UZ(1,"iframe",1),m.qZA()),2&p&&(m.xp6(1),m.Q6J("src",M.src,m.uOi))},styles:[".gleam[_ngcontent-%COMP%]{display:flex;margin:calc(var(--vertical-spacing) * -1)}iframe[_ngcontent-%COMP%]{width:100%;height:1000px}@media (max-width: 767.98px){iframe[_ngcontent-%COMP%]{padding:0 1rem}}"],changeDetection:0}),g})()}];let b=(()=>{class g{}return g.\u0275fac=function(p){return new(p||g)},g.\u0275mod=m.oAB({type:g}),g.\u0275inj=m.cJS({imports:[[F.Bz.forChild(Z)],F.Bz]}),g})(),L=(()=>{class g{}return g.\u0275fac=function(p){return new(p||g)},g.\u0275mod=m.oAB({type:g}),g.\u0275inj=m.cJS({imports:[[b]]}),g})();var w=s(72755),le=s(63900),z=s(28746),D=s(54004),_e=s(18505),K=s(13302),oe=s(52457);let q=(()=>{class g{constructor(p,M,S,y){this.apollo=p,this.recaptchaService=M,this.recaptchaDialogService=S,this.toastrService=y}join(p,M,S){return this.recaptchaService.setRequest("joinGiveaway",{giveawayId:p}).pipe((0,le.w)(y=>this.getJoinMutation(y).pipe(this.recaptchaDialogService.errorOp(H=>this.getJoinMutation(Object.assign(Object.assign({},y),{visualRecaptcha:H}))))),(0,z.x)(()=>M?M():null),(0,D.U)(({data:y})=>y.joinGiveaway.userGiveaway),(0,_e.b)(y=>{S&&this.toastrService.success(`You have joined ${y.giveaway.name} giveaway`)}))}addToResponse(p,M){if(!M)return p;const S={node:M,__typename:"GiveawayEdge"},H=p.giveaways.edges.findIndex(N=>N.node.id===S.node.id)<0?[...p.giveaways.edges,S]:p.giveaways.edges.map(N=>N.node.id!==S.node.id?N:Object.assign(Object.assign({},N),S));return Object.assign({},p,Object.assign(Object.assign({},p),{giveaways:Object.assign(Object.assign({},p.giveaways),{edges:H})}))}getJoinMutation(p){return this.apollo.mutate({mutation:e,variables:{input:p}})}}return g.\u0275fac=function(p){return new(p||g)(m.LFG(K._M),m.LFG(j.KvH),m.LFG(w.fQ),m.LFG(oe._W))},g.\u0275prov=m.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"}),g})()}}]);